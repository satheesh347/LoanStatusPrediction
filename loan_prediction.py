# -*- coding: utf-8 -*-
"""loan prediction

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1FQq9kG4THq8LyYLPl6Vm3AOYxDFyt_bo
"""

# Import necessary libraries
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split, cross_val_score, StratifiedKFold
from sklearn.linear_model import LogisticRegression
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import accuracy_score, classification_report, confusion_matrix

# Load the dataset
data = pd.read_csv('/content/sample_data/loan_approval_dataset.csv')
data

data = data.dropna()

data.nunique()

Y=data[' loan_status']
Y

X=data.drop(' loan_status',axis=1)
X

X=pd.get_dummies(X)
X

X_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size=0.2,random_state=42)

scaler= StandardScaler()

X_train = scaler.fit_transform(X_train)
X_test=scaler.transform(X_test)
model = LogisticRegression()
model.fit(X_train,Y_train)

Y_pred=model.predict(X_test)
Y_pred

import seaborn as sns
import matplotlib.pyplot as plt

# Get the confusion matrix
cm = confusion_matrix(Y_test, Y_pred)

# Define labels for the axes
labels = ['Not Approved', 'Approved']

# Plot the confusion matrix
fig, ax = plt.subplots(figsize=(5, 5))
sns.heatmap(cm, annot=True, linewidth=0.6, linecolor="r", fmt=".0f", ax=ax)

# Set axis labels and title
ax.set_xlabel('Predicted', fontsize=12)
ax.set_ylabel('True', fontsize=12)
ax.set_xticklabels(labels, fontsize=10)
ax.set_yticklabels(labels, fontsize=10)
ax.set_title('Confusion Matrix', fontsize=14)
plt.show()

accuracy = accuracy_score(Y_test, Y_pred)
print("Accuracy:", accuracy)

